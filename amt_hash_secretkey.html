<html>
<head> 

<link rel="stylesheet" href="web/setup/styles.css" type="text/css">
<script src="http://crypto-js.googlecode.com/svn/tags/3.1.2/build/rollups/hmac-sha1.js"></script>
<script src="http://crypto-js.googlecode.com/svn/tags/3.1.2/build/components/enc-base64-min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script type="text/javascript">

var hmac;

var doHash = function(){
    // Pre-hash the secret key
    var secret = $("input[name=sak]").val();
    hmac = CryptoJS.algo.HMAC.create(CryptoJS.algo.SHA1, secret);
}

var saveData = function(){
    var json = JSON.stringify(hmac);
    var toSave = new Blob([json], {type: "json"});
    var downloadLink = document.createElement("a");
    downloadLink.download = "amtsettings.js";
    downloadLink.innerHTML = "Download AMT settings";
    if (window.webkitURL != null)
	{
		downloadLink.href = window.webkitURL.createObjectURL(toSave);
	}
	else
	{
		downloadLink.href = window.URL.createObjectURL(toSave);
		downloadLink.onclick = function (event) {
            document.body.removeChild(event.target);
        };
		downloadLink.style.display = "none";
		document.body.appendChild(downloadLink);
	}

	downloadLink.click();
}

</script>

<body>

<div id="mainwrapper">

Welcome, Mechanical Turk Requester! <p>

In order to use Experigen's Amazon Mechanical Turk plugin for tasks like granting bonuses or giving out qualifications, it needs to know your AMT access key and the secret key as well. Your access key will be made public, but the secret key will not, as it will be irreversibly hashed for use in requests towards AMT.<p>


Access key ID: <input type="text" name="ak" maxlength="50" size="50"><br/><br/>
Secret access key: <input type="text" name="sak" maxlength="50" size="50" onchange="doHash();"><p>

To save the data the AMT plugin needs, click on the button below to save an <b>amtsettings.js</b> file and save the file to the <b>(EXPERIGEN HOME)/web/plugins/amt/</b> directory.<p>

<input type="submit" onclick="saveData();">

</div>

</body>

</html>
